\usepackage{listings} %box per codice sorgente
\usepackage{color}

\newcommand{\code}[1]{\texttt{#1} }

\newcounter{main}
\setcounter{main}{1}


\lstdefinelanguage{BASH}
{
    otherkeywords={=, +, [, ], (, ), \{, \}, *},
    %morecomment=[l]{#},
    %morestring=[s]{"}{"},
    morekeywords={make,apt-get,sudo},
    breaklines=true,
    keywordstyle=\bfseries,
    stringstyle=\color{red},
    emphstyle=\color{black}\bfseries,
    commentstyle=\color{dark-green}\slshape,
}

\lstnewenvironment{bash}[1][firstnumber=\themain,name=main]
  {\lstset{language=BASH,
           basicstyle=\ttfamily\footnotesize,
           numbers=left,
           numberstyle=\tiny\color{gray},
           backgroundcolor=\color{lightgray},
           breaklines=true,
           prebreak=\small\symbol{'134},
           breakatwhitespace=true,
           mathescape=false
           morecomment=[l]{\#}
           #1
          }
}
{\setcounter{main}{\value{lstnumber}}}

%XML
\definecolor{maroon}{rgb}{0.5,0,0}
\definecolor{darkgreen}{rgb}{0,0.5,0}
\lstdefinelanguage{XML}
{
  basicstyle=\ttfamily,
  morestring=[s]{"}{"},
  morecomment=[s]{?}{?},
  morecomment=[s]{!--}{--},
  commentstyle=\color{darkgreen},
  moredelim=[s][\color{black}]{>}{<},
  moredelim=[s][\color{red}]{\ }{=},
  stringstyle=\color{blue},
  identifierstyle=\color{maroon}
}

\lstnewenvironment{xml}[1][firstnumber=\themain,name=main]
  {\lstset{language=XML,
           basicstyle=\ttfamily\footnotesize,
           numbers=left,
           numberstyle=\tiny\color{gray},
           backgroundcolor=\color{lightgray},
           breaklines=true,
           breakatwhitespace=true,
           #1
          }
}
{\setcounter{main}{\value{lstnumber}}}

\definecolor{javared}{rgb}{0.6,0,0} % for strings
\definecolor{javagreen}{rgb}{0.25,0.5,0.35} % comments
\definecolor{javapurple}{rgb}{0.5,0,0.35} % keywords
\definecolor{javadocblue}{rgb}{0.25,0.35,0.75} % javadoc

%\lstdefinelanguage{JAVA}
%{
%
%}

\lstnewenvironment{java}[1][firstnumber=\themain,name=main]
  {\lstset{	language=Java,
			basicstyle=\ttfamily,
			keywordstyle=\color{javapurple}\bfseries,
			stringstyle=\color{javared},
			commentstyle=\color{javagreen},
			morecomment=[s][\color{javadocblue}]{/**}{*/},
			showspaces=false,
			showstringspaces=false
            basicstyle=\ttfamily\footnotesize,
            numbers=left,
            tabsize=2,
            numberstyle=\tiny\color{gray},
            backgroundcolor=\color{lightgray},
            breaklines=true,
            breakatwhitespace=true,
           #1
          }
}
{\setcounter{main}{\value{lstnumber}}}

%http://jevopi.blogspot.it/2010/03/nicely-formatted-listings-in-latex-with.html